generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model adm_variable {
  var_id    Int       @id @default(autoincrement())
  var_name  String    @unique @db.VarChar(50)
  var_value String?
  var_desc  String?   @db.VarChar(255)
  active    Boolean   @default(true)
  ins_by    String?   @db.VarChar(50)
  ins_date  DateTime  @default(now())
  chg_by    String?   @db.VarChar(50)
  chg_date  DateTime?
}

model asset {
  asset_id                         Int                @id @default(autoincrement())
  partno_id                        Int
  serno                            String             @db.VarChar(50)
  status_cd                        String             @default("FMC") @db.VarChar(10)
  loc_ida                          Int?
  loc_idc                          Int?
  nha_asset_id                     Int?
  cfg_set_id                       Int?
  active                           Boolean            @default(true)
  reportable                       Boolean            @default(true)
  cfo_tracked                      Boolean            @default(false)
  bad_actor                        Boolean            @default(false)
  valid                            Boolean            @default(false)
  val_by                           String?            @db.VarChar(50)
  val_date                         DateTime?
  uii                              String?            @db.VarChar(50)
  etic                             DateTime?
  lotno                            String?            @db.VarChar(50)
  mfg_date                         DateTime?
  accept_date                      DateTime?
  next_ndi_date                    DateTime?
  deployed_date                    DateTime?
  tcn                              String?            @db.VarChar(50)
  shipper                          String?            @db.VarChar(50)
  ship_date                        DateTime?
  recv_date                        DateTime?
  eti                              Decimal?           @db.Decimal(10, 2)
  eti_liate                        Decimal?           @db.Decimal(10, 2)
  in_transit                       Boolean            @default(false)
  tail_no                          String?            @db.VarChar(20)
  remarks                          String?
  ins_by                           String?            @db.VarChar(50)
  ins_date                         DateTime           @default(now())
  chg_by                           String?            @db.VarChar(50)
  chg_date                         DateTime?
  cfg_set                          cfg_set?           @relation(fields: [cfg_set_id], references: [cfg_set_id])
  location_asset_loc_idaTolocation location?          @relation("asset_loc_idaTolocation", fields: [loc_ida], references: [loc_id])
  location_asset_loc_idcTolocation location?          @relation("asset_loc_idcTolocation", fields: [loc_idc], references: [loc_id])
  asset                            asset?             @relation("assetToasset", fields: [nha_asset_id], references: [asset_id])
  other_asset                      asset[]            @relation("assetToasset")
  part_list                        part_list          @relation(fields: [partno_id], references: [partno_id])
  asset_inspection                 asset_inspection[]
  event                            event[]
  labor                            labor[]
  labor_part                       labor_part[]
  meter_hist                       meter_hist[]
  repair                           repair[]
  software_asset                   software_asset[]
  sorties                          sorties[]
  sru_order                        sru_order[]
  tcto_asset                       tcto_asset[]

  @@unique([partno_id, serno])
}

model asset_inspection {
  hist_id       Int       @id @default(autoincrement())
  asset_id      Int
  repair_id     Int?
  wuc_cd        String?   @db.VarChar(10)
  jst_id        Int?
  pmi_type      String?   @db.VarChar(20)
  complete_date DateTime?
  next_due_date DateTime?
  completed_etm Decimal?  @db.Decimal(10, 2)
  next_due_etm  Decimal?  @db.Decimal(10, 2)
  job_no        String?   @db.VarChar(20)
  completed_by  String?   @db.VarChar(50)
  valid         Boolean   @default(false)
  ins_by        String?   @db.VarChar(50)
  ins_date      DateTime  @default(now())
  chg_by        String?   @db.VarChar(50)
  chg_date      DateTime?
  asset         asset     @relation(fields: [asset_id], references: [asset_id])
  repair        repair?   @relation(fields: [repair_id], references: [repair_id])
}

model attachments {
  attachment_id   Int      @id @default(autoincrement())
  event_id        Int?
  repair_id       Int?
  attachment_name String   @db.VarChar(255)
  attachment_type String?  @db.VarChar(50)
  file_path       String   @db.VarChar(500)
  file_size       Int?
  mime_type       String?  @db.VarChar(100)
  ins_by          String?  @db.VarChar(50)
  ins_date        DateTime @default(now())
  event           event?   @relation(fields: [event_id], references: [event_id], onDelete: Cascade)
  repair          repair?  @relation(fields: [repair_id], references: [repair_id], onDelete: Cascade)
}

model audit_log {
  log_id     Int      @id @default(autoincrement())
  user_id    Int?
  action     String   @db.VarChar(20)
  table_name String   @db.VarChar(50)
  record_id  Int?
  old_values Json?
  new_values Json?
  ip_address String?  @db.VarChar(45)
  created_at DateTime @default(now())
  users      users?   @relation(fields: [user_id], references: [user_id])
}

model bad_actor {
  bad_actor_id       Int       @id @default(autoincrement())
  loc_id             Int?
  sys_id             Int?
  status_period      Int?
  status_period_type String?   @db.VarChar(20)
  status_count       Int?
  status_cd          String?   @db.VarChar(10)
  multi_ac           Boolean   @default(false)
  active             Boolean   @default(true)
  ins_by             String?   @db.VarChar(50)
  ins_date           DateTime  @default(now())
  chg_by             String?   @db.VarChar(50)
  chg_date           DateTime?
  location           location? @relation(fields: [loc_id], references: [loc_id])
}

model cfg_list {
  list_id                                Int       @id @default(autoincrement())
  cfg_set_id                             Int
  partno_p                               Int
  partno_c                               Int
  sort_order                             Int       @default(0)
  qpa                                    Int       @default(1)
  active                                 Boolean   @default(true)
  ins_by                                 String?   @db.VarChar(50)
  ins_date                               DateTime  @default(now())
  chg_by                                 String?   @db.VarChar(50)
  chg_date                               DateTime?
  cfg_set                                cfg_set   @relation(fields: [cfg_set_id], references: [cfg_set_id], onDelete: Cascade)
  part_list_cfg_list_partno_cTopart_list part_list @relation("cfg_list_partno_cTopart_list", fields: [partno_c], references: [partno_id])
  part_list_cfg_list_partno_pTopart_list part_list @relation("cfg_list_partno_pTopart_list", fields: [partno_p], references: [partno_id])
}

model cfg_meters {
  meter_id    Int       @id @default(autoincrement())
  cfg_set_id  Int
  meter_type  String?   @db.VarChar(20)
  meter_value Decimal?  @db.Decimal(10, 2)
  ins_by      String?   @db.VarChar(50)
  ins_date    DateTime  @default(now())
  chg_by      String?   @db.VarChar(50)
  chg_date    DateTime?
  cfg_set     cfg_set   @relation(fields: [cfg_set_id], references: [cfg_set_id], onDelete: Cascade)
}

model cfg_set {
  cfg_set_id  Int          @id @default(autoincrement())
  cfg_name    String       @db.VarChar(100)
  cfg_type    String?      @db.VarChar(20)
  pgm_id      Int
  partno_id   Int?
  description String?
  active      Boolean      @default(true)
  ins_by      String?      @db.VarChar(50)
  ins_date    DateTime     @default(now())
  chg_by      String?      @db.VarChar(50)
  chg_date    DateTime?
  asset       asset[]
  cfg_list    cfg_list[]
  cfg_meters  cfg_meters[]
  part_list   part_list?   @relation(fields: [partno_id], references: [partno_id])
  program     program      @relation(fields: [pgm_id], references: [pgm_id])
}

model code {
  code_id     Int          @id @default(autoincrement())
  code_type   String       @db.VarChar(50)
  code_value  String       @db.VarChar(50)
  description String?      @db.VarChar(255)
  active      Boolean      @default(true)
  sort_order  Int          @default(0)
  ins_by      String?      @db.VarChar(50)
  ins_date    DateTime     @default(now())
  chg_by      String?      @db.VarChar(50)
  chg_date    DateTime?
  code_group  code_group[]

  @@unique([code_type, code_value])
}

model code_group {
  cdgrp_id    Int      @id @default(autoincrement())
  group_cd    String   @db.VarChar(50)
  code_id     Int
  sort_order  Int      @default(0)
  description String?  @db.VarChar(255)
  ins_by      String?  @db.VarChar(50)
  ins_date    DateTime @default(now())
  code        code     @relation(fields: [code_id], references: [code_id])
}

model event {
  event_id    Int           @id @default(autoincrement())
  asset_id    Int
  loc_id      Int?
  job_no      String?       @db.VarChar(20)
  discrepancy String?
  start_job   DateTime?
  stop_job    DateTime?
  when_disc   String?       @db.VarChar(10)
  how_mal     String?       @db.VarChar(10)
  wuc_cd      String?       @db.VarChar(10)
  priority    String?       @db.VarChar(10)
  symbol      String?       @db.VarChar(10)
  event_type  String?       @db.VarChar(20)
  sortie_id   Int?
  source      String?       @db.VarChar(20)
  source_cat  String?       @db.VarChar(20)
  sent_imds   Boolean       @default(false)
  non_imds    Boolean       @default(false)
  valid       Boolean       @default(false)
  val_by      String?       @db.VarChar(50)
  val_date    DateTime?
  etic_date   DateTime?
  ins_by      String?       @db.VarChar(50)
  ins_date    DateTime      @default(now())
  chg_by      String?       @db.VarChar(50)
  chg_date    DateTime?
  attachments attachments[]
  asset       asset         @relation(fields: [asset_id], references: [asset_id])
  location    location?     @relation(fields: [loc_id], references: [loc_id])
  sorties     sorties?      @relation(fields: [sortie_id], references: [sortie_id])
  meter_hist  meter_hist[]
  repair      repair[]
  sru_order   sru_order[]
}

model labor {
  labor_id     Int            @id @default(autoincrement())
  repair_id    Int
  labor_seq    Int            @default(1)
  asset_id     Int?
  action_taken String?        @db.VarChar(10)
  how_mal      String?        @db.VarChar(10)
  when_disc    String?        @db.VarChar(10)
  type_maint   String?        @db.VarChar(10)
  cat_labor    String?        @db.VarChar(10)
  start_date   DateTime?
  stop_date    DateTime?
  hours        Decimal?       @db.Decimal(5, 2)
  crew_chief   String?        @db.VarChar(50)
  crew_size    Int?
  corrective   String?
  discrepancy  String?
  remarks      String?
  corrected_by String?        @db.VarChar(50)
  inspected_by String?        @db.VarChar(50)
  bit_log      String?
  sent_imds    Boolean        @default(false)
  valid        Boolean        @default(false)
  val_by       String?        @db.VarChar(50)
  val_date     DateTime?
  ins_by       String?        @db.VarChar(50)
  ins_date     DateTime       @default(now())
  chg_by       String?        @db.VarChar(50)
  chg_date     DateTime?
  asset        asset?         @relation(fields: [asset_id], references: [asset_id])
  repair       repair         @relation(fields: [repair_id], references: [repair_id], onDelete: Cascade)
  labor_bit_pc labor_bit_pc[]
  labor_part   labor_part[]
  meter_hist   meter_hist[]
}

model labor_bit_pc {
  labor_bit_id Int       @id @default(autoincrement())
  labor_id     Int
  bit_partno   String?   @db.VarChar(50)
  bit_name     String?   @db.VarChar(100)
  bit_seq      Int?
  bit_wuc      String?   @db.VarChar(10)
  how_mal      String?   @db.VarChar(10)
  bit_qty      Int?
  fsc          String?   @db.VarChar(10)
  bit_delete   Boolean   @default(false)
  valid        Boolean   @default(false)
  val_by       String?   @db.VarChar(50)
  val_date     DateTime?
  ins_by       String?   @db.VarChar(50)
  ins_date     DateTime  @default(now())
  labor        labor     @relation(fields: [labor_id], references: [labor_id], onDelete: Cascade)
}

model labor_part {
  labor_part_id Int        @id @default(autoincrement())
  labor_id      Int
  asset_id      Int?
  partno_id     Int?
  part_action   String?    @db.VarChar(20)
  qty           Int        @default(1)
  ins_by        String?    @db.VarChar(50)
  ins_date      DateTime   @default(now())
  chg_by        String?    @db.VarChar(50)
  chg_date      DateTime?
  asset         asset?     @relation(fields: [asset_id], references: [asset_id])
  labor         labor      @relation(fields: [labor_id], references: [labor_id], onDelete: Cascade)
  part_list     part_list? @relation(fields: [partno_id], references: [partno_id])
}

model loc_set {
  set_id       Int       @id @default(autoincrement())
  set_name     String    @db.VarChar(100)
  pgm_id       Int
  loc_id       Int
  display_name String?   @db.VarChar(255)
  active       Boolean   @default(true)
  ins_by       String?   @db.VarChar(50)
  ins_date     DateTime  @default(now())
  chg_by       String?   @db.VarChar(50)
  chg_date     DateTime?
  location     location  @relation(fields: [loc_id], references: [loc_id])
  program      program   @relation(fields: [pgm_id], references: [pgm_id])

  @@unique([set_name, loc_id])
}

model location {
  loc_id                        Int                @id @default(autoincrement())
  majcom_cd                     String?            @db.VarChar(10)
  site_cd                       String?            @db.VarChar(20)
  unit_cd                       String?            @db.VarChar(20)
  squad_cd                      String?            @db.VarChar(20)
  description                   String?            @db.VarChar(255)
  geoloc                        String?            @db.VarChar(100)
  display_name                  String             @db.VarChar(100)
  old_loc_id                    Int?
  active                        Boolean            @default(true)
  ins_by                        String?            @db.VarChar(50)
  ins_date                      DateTime           @default(now())
  chg_by                        String?            @db.VarChar(50)
  chg_date                      DateTime?
  asset_asset_loc_idaTolocation asset[]            @relation("asset_loc_idaTolocation")
  asset_asset_loc_idcTolocation asset[]            @relation("asset_loc_idcTolocation")
  bad_actor                     bad_actor[]
  event                         event[]
  loc_set                       loc_set[]
  notification                  notification[]
  program_location              program_location[]
  spares                        spares[]
  sru_order                     sru_order[]
  user_location                 user_location[]
}

model meter_hist {
  meter_id     Int       @id @default(autoincrement())
  asset_id     Int
  repair_id    Int?
  labor_id     Int?
  event_id     Int?
  meter_type   String?   @db.VarChar(20)
  meter_action String?   @db.VarChar(20)
  meter_in     Decimal?  @db.Decimal(10, 2)
  meter_out    Decimal?  @db.Decimal(10, 2)
  changed      Boolean   @default(false)
  failure      Boolean   @default(false)
  seq_num      Int?
  remarks      String?
  valid        Boolean   @default(false)
  ins_by       String?   @db.VarChar(50)
  ins_date     DateTime  @default(now())
  chg_by       String?   @db.VarChar(50)
  chg_date     DateTime?
  asset        asset     @relation(fields: [asset_id], references: [asset_id])
  event        event?    @relation(fields: [event_id], references: [event_id])
  labor        labor?    @relation(fields: [labor_id], references: [labor_id])
  repair       repair?   @relation(fields: [repair_id], references: [repair_id])
}

model notification {
  msg_id       Int       @id @default(autoincrement())
  pgm_id       Int?
  loc_id       Int?
  msg_text     String
  priority     String?   @db.VarChar(20)
  start_date   DateTime?
  stop_date    DateTime?
  from_user    String?   @db.VarChar(50)
  to_user      String?   @db.VarChar(50)
  acknowledged Boolean   @default(false)
  ack_by       String?   @db.VarChar(50)
  ack_date     DateTime?
  active       Boolean   @default(true)
  ins_by       String?   @db.VarChar(50)
  ins_date     DateTime  @default(now())
  location     location? @relation(fields: [loc_id], references: [loc_id])
  program      program?  @relation(fields: [pgm_id], references: [pgm_id])
}

model part_list {
  partno_id                             Int          @id @default(autoincrement())
  partno                                String       @db.VarChar(50)
  pgm_id                                Int
  sys_type                              String?      @db.VarChar(20)
  noun                                  String?      @db.VarChar(100)
  nsn                                   String?      @db.VarChar(20)
  cage                                  String?      @db.VarChar(10)
  nha_id                                Int?
  config                                String?      @db.VarChar(50)
  unit_price                            Decimal?     @db.Decimal(12, 2)
  sn_tracked                            Boolean      @default(true)
  wuc_cd                                String?      @db.VarChar(10)
  mds_cd                                String?      @db.VarChar(10)
  version                               String?      @db.VarChar(20)
  errc                                  String?      @db.VarChar(10)
  lsru_flag                             Boolean      @default(false)
  loc_idr                               Int?
  active                                Boolean      @default(true)
  valid                                 Boolean      @default(false)
  val_by                                String?      @db.VarChar(50)
  val_date                              DateTime?
  ins_by                                String?      @db.VarChar(50)
  ins_date                              DateTime     @default(now())
  chg_by                                String?      @db.VarChar(50)
  chg_date                              DateTime?
  asset                                 asset[]
  cfg_list_cfg_list_partno_cTopart_list cfg_list[]   @relation("cfg_list_partno_cTopart_list")
  cfg_list_cfg_list_partno_pTopart_list cfg_list[]   @relation("cfg_list_partno_pTopart_list")
  cfg_set                               cfg_set[]
  labor_part                            labor_part[]
  part_list                             part_list?   @relation("part_listTopart_list", fields: [nha_id], references: [partno_id])
  other_part_list                       part_list[]  @relation("part_listTopart_list")
  program                               program      @relation(fields: [pgm_id], references: [pgm_id])
  sru_order                             sru_order[]

  @@unique([partno, pgm_id])
}

model program {
  pgm_id           Int                @id @default(autoincrement())
  pgm_cd           String             @unique @db.VarChar(10)
  pgm_name         String             @db.VarChar(100)
  pgm_desc         String?
  active           Boolean            @default(true)
  ins_by           String?            @db.VarChar(50)
  ins_date         DateTime           @default(now())
  chg_by           String?            @db.VarChar(50)
  chg_date         DateTime?
  cfg_set          cfg_set[]
  loc_set          loc_set[]
  notification     notification[]
  part_list        part_list[]
  program_location program_location[]
  sorties          sorties[]
  spares           spares[]
  tcto             tcto[]
  user_program     user_program[]
}

model program_location {
  program_location_id Int       @id @default(autoincrement())
  pgm_id              Int
  loc_id              Int
  active              Boolean   @default(true)
  ins_by              String?   @db.VarChar(50)
  ins_date            DateTime  @default(now())
  chg_by              String?   @db.VarChar(50)
  chg_date            DateTime?
  location            location  @relation(fields: [loc_id], references: [loc_id], onDelete: Cascade)
  program             program   @relation(fields: [pgm_id], references: [pgm_id], onDelete: Cascade)

  @@unique([pgm_id, loc_id])
}

model repair {
  repair_id        Int                @id @default(autoincrement())
  event_id         Int
  repair_seq       Int                @default(1)
  asset_id         Int?
  start_date       DateTime?
  stop_date        DateTime?
  type_maint       String?            @db.VarChar(10)
  how_mal          String?            @db.VarChar(10)
  when_disc        String?            @db.VarChar(10)
  shop_status      String?            @db.VarChar(20)
  narrative        String?
  tag_no           String?            @db.VarChar(50)
  doc_no           String?            @db.VarChar(50)
  eti_in           Decimal?           @db.Decimal(10, 2)
  eti_out          Decimal?           @db.Decimal(10, 2)
  eti_delta        Decimal?           @db.Decimal(10, 2)
  micap            Boolean            @default(false)
  micap_login      String?            @db.VarChar(50)
  damage           String?            @db.VarChar(100)
  chief_review     Boolean            @default(false)
  super_review     Boolean            @default(false)
  eti_change       Boolean            @default(false)
  repeat_recur     Boolean            @default(false)
  sent_imds        Boolean            @default(false)
  valid            Boolean            @default(false)
  val_by           String?            @db.VarChar(50)
  val_date         DateTime?
  ins_by           String?            @db.VarChar(50)
  ins_date         DateTime           @default(now())
  chg_by           String?            @db.VarChar(50)
  chg_date         DateTime?
  asset_inspection asset_inspection[]
  attachments      attachments[]
  labor            labor[]
  meter_hist       meter_hist[]
  asset            asset?             @relation(fields: [asset_id], references: [asset_id])
  event            event              @relation(fields: [event_id], references: [event_id], onDelete: Cascade)
  sru_order        sru_order[]
  tcto_asset       tcto_asset[]
}

model software {
  sw_id          Int              @id @default(autoincrement())
  sw_number      String           @db.VarChar(50)
  sw_type        String?          @db.VarChar(20)
  sys_id         Int?
  revision       String?          @db.VarChar(20)
  revision_date  DateTime?
  sw_title       String?          @db.VarChar(100)
  sw_desc        String?
  eff_date       DateTime?
  cpin_flag      Boolean          @default(false)
  active         Boolean          @default(true)
  valid          Boolean          @default(false)
  val_by         String?          @db.VarChar(50)
  val_date       DateTime?
  ins_by         String?          @db.VarChar(50)
  ins_date       DateTime         @default(now())
  chg_by         String?          @db.VarChar(50)
  chg_date       DateTime?
  software_asset software_asset[]
}

model software_asset {
  sw_asset_id Int       @id @default(autoincrement())
  asset_id    Int
  sw_id       Int
  eff_date    DateTime?
  ins_by      String?   @db.VarChar(50)
  ins_date    DateTime  @default(now())
  asset       asset     @relation(fields: [asset_id], references: [asset_id], onDelete: Cascade)
  software    software  @relation(fields: [sw_id], references: [sw_id])

  @@unique([asset_id, sw_id])
}

model sorties {
  sortie_id       Int       @id @default(autoincrement())
  pgm_id          Int
  asset_id        Int?
  mission_id      String?   @db.VarChar(50)
  serno           String?   @db.VarChar(50)
  ac_tailno       String?   @db.VarChar(20)
  sortie_date     DateTime?
  sortie_effect   String?   @db.VarChar(10)
  ac_station      String?   @db.VarChar(20)
  ac_type         String?   @db.VarChar(20)
  current_unit    String?   @db.VarChar(20)
  assigned_unit   String?   @db.VarChar(20)
  range           String?   @db.VarChar(20)
  reason          String?   @db.VarChar(100)
  remarks         String?
  source_data     String?   @db.VarChar(50)
  is_non_podded   Boolean   @default(false)
  is_debrief      Boolean   @default(false)
  is_live_monitor Boolean   @default(false)
  valid           Boolean   @default(false)
  val_by          String?   @db.VarChar(50)
  val_date        DateTime?
  ins_by          String?   @db.VarChar(50)
  ins_date        DateTime  @default(now())
  chg_by          String?   @db.VarChar(50)
  chg_date        DateTime?
  event           event[]
  asset           asset?    @relation(fields: [asset_id], references: [asset_id])
  program         program   @relation(fields: [pgm_id], references: [pgm_id])
}

model spares {
  spare_id     Int       @id @default(autoincrement())
  pgm_id       Int
  partno       String    @db.VarChar(50)
  serno        String    @db.VarChar(50)
  status       String    @default("AVAILABLE") @db.VarChar(20)
  loc_id       Int?
  warranty_exp DateTime?
  mfg_date     DateTime?
  unit_price   Decimal?  @db.Decimal(12, 2)
  remarks      String?
  active       Boolean   @default(true)
  ins_by       String?   @db.VarChar(50)
  ins_date     DateTime  @default(now())
  chg_by       String?   @db.VarChar(50)
  chg_date     DateTime?
  location     location? @relation(fields: [loc_id], references: [loc_id])
  program      program   @relation(fields: [pgm_id], references: [pgm_id])

  @@unique([partno, serno])
}

model sru_order {
  order_id           Int                 @id @default(autoincrement())
  event_id           Int?
  repair_id          Int?
  partno_id          Int?
  asset_id           Int?
  loc_id             Int?
  sru_id             String?             @db.VarChar(50)
  doc_no             String?             @db.VarChar(50)
  order_date         DateTime?
  order_qty          Int                 @default(1)
  status             String              @default("REQUEST") @db.VarChar(20)
  micap              Boolean             @default(false)
  delivery_dest      String?             @db.VarChar(100)
  delivery_priority  String?             @db.VarChar(20)
  ujc                String?             @db.VarChar(20)
  acknowledge_date   DateTime?
  fill_date          DateTime?
  repl_sru_ship_date DateTime?
  repl_sru_recv_date DateTime?
  shipper            String?             @db.VarChar(50)
  tcn                String?             @db.VarChar(50)
  rem_shipper        String?             @db.VarChar(50)
  rem_tcn            String?             @db.VarChar(50)
  rem_sru_ship_date  DateTime?
  receiver           String?             @db.VarChar(50)
  receive_qty        Int?
  receive_date       DateTime?
  esd                DateTime?
  wuc_cd             String?             @db.VarChar(10)
  remarks            String?
  active             Boolean             @default(true)
  ins_by             String?             @db.VarChar(50)
  ins_date           DateTime            @default(now())
  chg_by             String?             @db.VarChar(50)
  chg_date           DateTime?
  asset              asset?              @relation(fields: [asset_id], references: [asset_id])
  event              event?              @relation(fields: [event_id], references: [event_id])
  location           location?           @relation(fields: [loc_id], references: [loc_id])
  part_list          part_list?          @relation(fields: [partno_id], references: [partno_id])
  repair             repair?             @relation(fields: [repair_id], references: [repair_id])
  sru_order_history  sru_order_history[]
}

model sru_order_history {
  history_id     Int       @id @default(autoincrement())
  order_id       Int
  timestamp      DateTime  @default(now())
  user_id        Int
  username       String    @db.VarChar(50)
  user_full_name String    @db.VarChar(100)
  action_type    String    @db.VarChar(20)
  status         String    @db.VarChar(20)
  description    String
  metadata       Json?     @default("{}")
  ins_date       DateTime  @default(now())
  sru_order      sru_order @relation(fields: [order_id], references: [order_id], onDelete: Cascade)
}

model tcto {
  tcto_id       Int          @id @default(autoincrement())
  pgm_id        Int
  tcto_no       String       @db.VarChar(50)
  tcto_type     String?      @db.VarChar(20)
  tcto_code     String?      @db.VarChar(20)
  wuc_cd        String?      @db.VarChar(10)
  sys_type      String?      @db.VarChar(20)
  station_type  String?      @db.VarChar(20)
  old_partno_id Int?
  new_partno_id Int?
  eff_date      DateTime?
  remarks       String?
  active        Boolean      @default(true)
  ins_by        String?      @db.VarChar(50)
  ins_date      DateTime     @default(now())
  chg_by        String?      @db.VarChar(50)
  chg_date      DateTime?
  program       program      @relation(fields: [pgm_id], references: [pgm_id])
  tcto_asset    tcto_asset[]

  @@unique([tcto_no, pgm_id])
}

model tcto_asset {
  tcto_asset_id Int       @id @default(autoincrement())
  tcto_id       Int
  asset_id      Int
  repair_id     Int?
  complete_date DateTime?
  remarks       String?
  valid         Boolean   @default(false)
  val_by        String?   @db.VarChar(50)
  val_date      DateTime?
  ins_by        String?   @db.VarChar(50)
  ins_date      DateTime  @default(now())
  chg_by        String?   @db.VarChar(50)
  chg_date      DateTime?
  asset         asset     @relation(fields: [asset_id], references: [asset_id])
  repair        repair?   @relation(fields: [repair_id], references: [repair_id])
  tcto          tcto      @relation(fields: [tcto_id], references: [tcto_id], onDelete: Cascade)

  @@unique([tcto_id, asset_id])
}

model user_location {
  user_location_id Int      @id @default(autoincrement())
  user_id          Int
  loc_id           Int
  is_default       Boolean  @default(false)
  ins_by           String?  @db.VarChar(50)
  ins_date         DateTime @default(now())
  location         location @relation(fields: [loc_id], references: [loc_id])
  users            users    @relation(fields: [user_id], references: [user_id], onDelete: Cascade)

  @@unique([user_id, loc_id])
}

model user_program {
  user_program_id Int      @id @default(autoincrement())
  user_id         Int
  pgm_id          Int
  is_default      Boolean  @default(false)
  ins_by          String?  @db.VarChar(50)
  ins_date        DateTime @default(now())
  program         program  @relation(fields: [pgm_id], references: [pgm_id])
  users           users    @relation(fields: [user_id], references: [user_id], onDelete: Cascade)

  @@unique([user_id, pgm_id])
}

model users {
  user_id       Int             @id @default(autoincrement())
  username      String          @unique @db.VarChar(50)
  password_hash String          @db.VarChar(255)
  email         String          @unique @db.VarChar(100)
  first_name    String          @db.VarChar(50)
  last_name     String          @db.VarChar(50)
  role          UserRole        @default(VIEWER)
  active        Boolean         @default(true)
  last_login    DateTime?
  ins_by        String?         @db.VarChar(50)
  ins_date      DateTime        @default(now())
  chg_by        String?         @db.VarChar(50)
  chg_date      DateTime?
  audit_log     audit_log[]
  user_location user_location[]
  user_program  user_program[]
}

enum UserRole {
  ADMIN
  DEPOT_MANAGER
  FIELD_TECHNICIAN
  VIEWER
}
